# MCAS-vascular-aging

This repository contains the code and processed data supporting the manuscript:

**Role of Gut Microbiota-Derived Metabolites in Vascular Aging:  
A Systems Biological Approach through MCAS Model**

The repository provides the computational implementation of the **Microbial Cardiovascular Aging Signature (MCAS)** framework and the corresponding processed datasets used for model training, validation, and ablation analyses, as described in the manuscript.

---

## Repository Contents

### Code

**MCAS_scripts.txt**  
Primary analysis script implementing the MCAS modeling workflow reported in the manuscript.  
The script performs:

- Loading and alignment of processed multi-layer feature matrices  
- Nested cross-validation–based classification  
- Performance evaluation using ROC-AUC, PR-AUC, and Brier score  
- Non-parametric bootstrap estimation of AUC confidence intervals  
- Calibration analysis using equal-frequency probability bins  
- Ablation analyses across microbial (M), metabolic (K), epigenomic (E), and combined feature sets  

The script operates exclusively on the processed datasets provided in the `data/` directory.

**Supplementary_Code_MCAS.txt**  
Supplementary executable code accompanying the manuscript.  
This file provides a transparent and executable representation of the modeling and validation procedures reported in the study, including:

- Input requirements and feature structure  
- Construction of the MCAS predictive model  
- Nested cross-validation design (outer = 5, inner = 3)  
- Metric computation (ROC-AUC, PR-AUC, Brier score)  
- Bootstrap-based confidence interval estimation  
- Calibration curve generation  
- Ablation configurations and result export  

It is provided to support methodological transparency and reproducibility of the analyses described in the manuscript.

---

### Data

All data included in this repository are **processed outputs** derived from publicly available microbiome resources.  
No raw sequencing, metabolomic, or epigenomic data are distributed.

The `data/` directory contains:

**integrated_matrix.csv**  
Concatenated feature matrix composed of six PCA-derived components  
(meta_PC1–2, metabo_PC1–2, epi_PC1–2), one row per SampleID.

**labels.csv**  
Binary classification target used for model training  
(Class: 0 = healthy/younger, 1 = vascular-aged).

**Supplementary_Data1.csv**  
Integrated feature matrix with corresponding class labels.

**Supplementary_Data2.csv**  
Sample-level class labels in machine-readable format.

**Supplementary_Data3.txt**  
Description of processed datasets, data provenance, and feature structure.

**Supplementary_Data4.json**  
Machine-readable summary of model performance metrics, including  
nested cross-validation AUC, PR-AUC, Brier score, and 95% confidence interval.

**Supplementary_Data5.json**  
Ablation analysis results reporting performance metrics for all evaluated model configurations  
(M-only, K-only, E-only, pairwise combinations, and full MCAS model).

---

### Results

**results/**  
Directory reserved for numerical outputs generated by the analysis scripts.

**figures/**  
Directory containing figures generated by the scripts, including:

- ROC curve based on outer-fold predictions  
- Calibration plot with confidence intervals  
- Ablation performance summaries  

These outputs correspond to figures and supplementary materials described in the manuscript.

---

## Data Provenance

All processed data are derived from publicly available datasets reported in:

Yatsunenko T. et al., *Nature* (2012), 486(7402), 222–227  

MG-RAST accessions:  
- qiime:850 (16S rRNA gene sequencing)  
- qiime:621 (shotgun metagenomics)

Only anonymized, previously collected, open-access data were used.  
No new human or animal data were generated for this study.

---

## Reproducibility

The repository is structured to enable reproduction of the analyses reported in the manuscript using the provided processed datasets and scripts.

All model parameters, validation strategies, feature definitions, and performance metrics correspond directly to those described in the **Materials and Methods** and **Results** sections of the paper.

---

## License

This repository is distributed under the **MIT License**.  
See the `LICENSE` file for details.

---

## Notes

This repository is intended to complement the associated manuscript and does not function as a standalone clinical prediction tool.

The MCAS framework is provided for research and methodological transparency purposes only.
